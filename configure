#!/bin/sh -eu

rm -f config.mk

# Consistent BSD interface
case "$(uname -s)" in
	Darwin|DragonFly|*BSD)
		# built in
		;;
	*)
		pkg-config --print-errors libbsd-overlay
		cat >> config.mk <<-EOF
			CFLAGS += $(pkg-config --cflags libbsd-overlay)
			LDFLAGS += $(pkg-config --libs libbsd-overlay)
		EOF
esac

# LibreSSL
case "$(uname -s)" in
	OpenBSD)
		# built in
		;;
	*)
		pkg-config --print-errors 'libtls >= 2.5.0'
		cat >> config.mk <<-EOF
			CFLAGS += $(pkg-config --cflags libtls)
			LDFLAGS += $(pkg-config --libs libtls)
		EOF
esac
